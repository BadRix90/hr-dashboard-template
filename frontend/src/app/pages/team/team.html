<div class="page-container">
  <header class="page-header">
    <h1>{{ text.team.title }}</h1>
    <p class="text-secondary">{{ text.team.subtitle }}</p>
  </header>

  <div class="stats-row">
    <div class="stat-card">
      <h3>{{ text.team.totalMembers }}</h3>
      <p class="stat-value">{{ totalMembers }}</p>
    </div>
    <div class="stat-card">
      <h3>{{ text.team.activeToday }}</h3>
      <p class="stat-value">{{ activeToday }}</p>
    </div>
    <div class="stat-card">
      <h3>{{ text.team.onVacation }}</h3>
      <p class="stat-value">{{ onVacation }}</p>
    </div>
  </div>

  <div class="content-section">
    <div class="section-header">
      <h2>{{ text.team.teamMembers }}</h2>
      <div class="header-actions">
        <input type="text" class="search-input" [placeholder]="text.team.searchMembers" [(ngModel)]="searchTerm">
        <button class="btn-primary" (click)="addMember()">
          <mat-icon>add</mat-icon>
          {{ text.team.addMember }}
        </button>
      </div>
    </div>

    @if (loading) {
      <p>Lade Teammitglieder...</p>
    } @else if (filteredMembers.length === 0) {
      <p>Keine Teammitglieder gefunden</p>
    } @else {
      <div class="team-list">
        @for (member of filteredMembers; track member.id) {
          <div class="member-row">
            <div class="member-avatar">
              <img [src]="member.avatar" [alt]="member.name">
            </div>

            <div class="member-info">
              <div class="member-name">{{ member.name }}</div>
              <div class="member-role">{{ member.role }}</div>
            </div>

            <div class="member-department">
              {{ member.department }}
            </div>

            <div class="member-status" [class]="getStatusClass(member.status)">
              <mat-icon>{{ getStatusIcon(member.status) }}</mat-icon>
              <span>{{ getStatusText(member.status) }}</span>
            </div>

            <div class="member-stats">
              <div class="stat-item">
                <mat-icon>schedule</mat-icon>
                <span>{{ member.hoursThisWeek }}h</span>
              </div>
              <div class="stat-item">
                <mat-icon>calendar_today</mat-icon>
                <span>{{ member.vacationDays }} Tage</span>
              </div>
            </div>

            <div class="member-actions">
              <button mat-icon-button [matMenuTriggerFor]="menu">
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #menu="matMenu">
                <button mat-menu-item (click)="viewMember(member.id)">
                  <mat-icon>visibility</mat-icon>
                  <span>Ansehen</span>
                </button>
                <button mat-menu-item (click)="editMember(member.id)">
                  <mat-icon>edit</mat-icon>
                  <span>Bearbeiten</span>
                </button>
                <button mat-menu-item (click)="deleteMember(member.id)" class="delete-action">
                  <mat-icon>delete</mat-icon>
                  <span>LÃ¶schen</span>
                </button>
              </mat-menu>
            </div>
          </div>
        }
      </div>
    }
  </div>

  <div class="content-section">
    <h2>{{ text.team.departmentDistribution }}</h2>
    <div class="department-chart">
      @for (dept of departments; track dept.name) {
        <div class="department-item">
          <div class="dept-header">
            <span class="dept-name">{{ dept.name }}</span>
            <span class="dept-count">{{ dept.count }} {{ text.team.members }}</span>
          </div>
          <div class="dept-bar">
            <div class="bar-fill" [style.width.%]="(dept.count / totalMembers) * 100"></div>
          </div>
        </div>
      }
    </div>
  </div>
</div>
