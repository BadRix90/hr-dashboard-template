<div class="page-container">
  <header class="page-header">
    <h1>{{ text.timeTracking.title }}</h1>
    <p class="text-secondary">{{ text.timeTracking.subtitle }}</p>
  </header>

  <div class="timer-section">
    <div class="timer-card">
      <div class="timer-display">
        <span class="time">{{ currentTime }}</span>
      </div>
      <div class="timer-controls">
        <button class="btn-start" [disabled]="isTracking" (click)="startTracking()">{{ text.timeTracking.start }}</button>
        <button class="btn-stop" [disabled]="!isTracking" (click)="stopTracking()">{{ text.timeTracking.stop }}</button>
      </div>
      <div class="timer-info">
        <span class="today-hours">{{ text.timeTracking.today }}: {{ todayHours }}{{ text.timeTracking.hours }}</span>
        <span class="week-hours">{{ text.timeTracking.thisWeek }}: {{ weekHours }}{{ text.timeTracking.hours }}</span>
      </div>
    </div>
  </div>

  <div class="content-section">
    <div class="section-header">
      <h2>{{ text.timeTracking.timeEntries }}</h2>
      <button class="btn-secondary" (click)="addManualEntry()">{{ text.timeTracking.addManualEntry }}</button>
    </div>

    @if (loading) {
      <p>Lade Zeiteinträge...</p>
    } @else if (timeEntries.length === 0) {
      <p>Keine Zeiteinträge vorhanden</p>
    } @else {
      <div class="entries-list">
        @for (entry of timeEntries; track entry.id) {
          <div class="entry-item">
            <div class="entry-date">
              <mat-icon>calendar_today</mat-icon>
              <span>{{ entry.date }}</span>
            </div>
            <div class="entry-details">
              <div class="entry-time">
                <span class="time-range">{{ entry.start_time }} - {{ entry.end_time }}</span>
                <span class="duration">{{ entry.duration }}{{ text.timeTracking.hours }}</span>
              </div>
              <p class="entry-project" *ngIf="entry.project">{{ entry.project }}</p>
              <p class="entry-description" *ngIf="entry.description">{{ entry.description }}</p>
            </div>
            <div class="entry-actions">
              <button mat-icon-button (click)="editEntry(entry.id)">
                <mat-icon>edit</mat-icon>
              </button>
              <button mat-icon-button (click)="deleteEntry(entry.id)">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        }
      </div>
    }
  </div>

  <div class="content-section">
    <h2>{{ text.timeTracking.weeklyOverview }}</h2>
    <div class="week-chart">
      @for (day of weekData; track day.day) {
        <div class="day-bar">
          <div class="bar" [style.height.%]="(day.hours / 12) * 100"></div>
          <span class="hours">{{ day.hours }}{{ text.timeTracking.hours }}</span>
          <span class="day-label">{{ day.day }}</span>
        </div>
      }
    </div>
  </div>
</div>
